function modalDialogLink(n,t,i){var u;jQuery(".qtip.ui-tooltip-help").qtip("hide");var e=jQuery(n),f=Math.floor(Math.random()*1e7),o="SitkajQueryModalDialogUniqueID"+f,s="SitkajQueryModalDialogContentUniqueID"+f,r;return r=typeof i=="function"?i():i,u={type:"GET",url:n.href},r!=null&&(u={type:"POST",url:n.href,data:JSON.stringify(r),contentType:"application/json"}),SitkaAjax.ajax(u,function(n){createBootstrapDialogForm(e,o,s,t,n)}),!1}function findBootstrapDialogForm(n,t){var i;if(Sitka.Methods.isUndefinedNullOrEmpty(n)||(i=jQuery("#"+n,t)),Sitka.Methods.isUndefinedNullOrEmpty(i)&&(i=jQuery("form",t)),i.length>1)throw new Error("Found more than 1 form to post!  Cannot proceed.");return i}function createBootstrapDialogForm(n,t,i,r,u){var l=n.attr("data-dialog-title"),e=parseInt(n.attr("data-dialog-width")),o;e=e==0?"auto":e+"px";var h=n.attr("data-save-button-id"),a=n.attr("data-save-button-text"),s=n.attr("data-cancel-button-id"),v=n.attr("data-cancel-button-text"),c=n.attr("data-optional-dialog-form-id"),y=n.attr("data-skip-ajax").toLowerCase()==="true"?!0:!1,f=jQuery(getModalDialogFromHtmlTemplate(t,l,u,e,a,h,v,s));f.modal({backdrop:"static"});f.draggable({handle:".modal-header"});o=jQuery("#"+h);o.on("click",function(){o.attr("disabled","disabled");jQuery("#"+s).attr("disabled","disabled");jQuery(".modal-close-button").attr("disabled","disabled");var n=findBootstrapDialogForm(c,f);return n.valid()?(n.submit(),!0):(o.attr("disabled",!1),jQuery("#"+s).attr("disabled",!1),jQuery(".modal-close-button").attr("disabled",!1),!1)});f.on("hide.bs.modal",function(){jQuery("*",f).qtip("hide")});f.on("hidden.bs.modal",function(){jQuery("#"+t).remove()});wireUpModalDialogForm(f,r,c,y,n)}function wireUpModalDialogForm(n,t,i,r,u){if(jQuery.validator.unobtrusive.parse(n),convertJQueryValidationErrorsToQtip(),Sitka.Methods.isUndefinedNullOrEmpty(r)&&(r=!1),Sitka.Methods.isUndefinedNullOrEmpty(t)||t(),jQuery(".sitkaDatePicker").datepicker(),!r){var f=findBootstrapDialogForm(i,n);f.ajaxForm({url:this.action,type:this.method,beforeSubmit:function(){jQuery(".progress-bar").html("Saving");jQuery(".progress").show()},success:function(f,e,o){SitkaAjax.handleLoginRedirect(f,e,o,function(){if(jQuery(".progress").hide(),Sitka.Methods.isUndefinedNullOrEmpty(f)||Sitka.Methods.isUndefinedNullOrEmpty(f.Success)||!f.Success){n.find(".modal-body").html(f);var e=u.attr("data-save-button-id"),o=u.attr("data-cancel-button-id");n.find("#"+e).attr("disabled",!1);n.find("#"+o).attr("disabled",!1);n.find(".modal-close-button").attr("disabled",!1);wireUpModalDialogForm(n,t,i,r,u)}else n.modal("hide"),Sitka.Methods.isUndefinedNullOrEmpty(f.RedirectUrl)?window.location.reload():window.location.href=f.RedirectUrl})},error:function(t,i){jQuery(".progress").hide();n.modal("hide");SitkaAjax.errorHandler(t,i)}})}}function getModalDialogFromHtmlTemplate(n,t,i,r,u,f,e,o){var s=i.indexOf("requiredFieldIcon")!==-1,h=s?'<span><sup><span class="glyphicon glyphicon-flash" style="color: #800020; font-size: 8px; "><\/span><\/sup> Required Field<\/span>':"";return"<div class='modal firma-modal' id='"+n+"' tabindex='-1'><div class='modal-dialog firma-modal-dialog' style = 'width:90%; max-width: "+r+"'><div class='modal-content'><div class='modal-header'><button type='button' class='modal-close-button btn btn-xs btn-firma' data-dismiss='modal'><span>&times;<\/span><\/button><span class='modal-title'>"+t+"<\/span><\/div><div class='modal-body'>"+i+"<\/div><div class='modal-footer'>"+h+"<div class='modal-footer-buttons'><button type='button' id='"+f+"' class='btn btn-xs btn-firma'>"+u+"<\/button><button type='button' id='"+o+"' class='btn btn-xs btn-firma' data-dismiss='modal'>"+e+"<\/button><\/div><\/div><div class='progress' style='display:none'><div class='progress-bar progress-bar-info progress-bar-striped active' role='progressbar' style='width:100%'>Saving<\/div><\/div><\/div><\/div><\/div>"}